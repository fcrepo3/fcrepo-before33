<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="AuthorizationXACML_files/filelist.xml">
<title>Authorization:&nbsp;XACML Policy Enforcement for Fedora</title>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<link rel=Stylesheet type="text/css" media=all href="../../docstyle.css">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-2147482993 6144 0 0 31 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-believe-normal-left:yes;}
h1
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:110%;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:24.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h2
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:18.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h3
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:14.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h4
	{margin-top:1.5pt;
	margin-right:0in;
	margin-bottom:1.5pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:4;
	font-size:13.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
h5
	{margin-top:1.5pt;
	margin-right:0in;
	margin-bottom:1.5pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:5;
	font-size:12.0pt;
	font-family:"Times New Roman";
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
pre
	{font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
p.sect, li.sect, div.sect
	{mso-style-name:sect;
	margin-bottom:3.75pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.code, li.code, div.code
	{mso-style-name:code;
	margin:3.75pt;
	mso-pagination:widow-orphan;
	background:#DDDDFF;
	border:none;
	mso-border-alt:solid black .75pt;
	padding:0in;
	mso-padding-alt:4.0pt 4.0pt 4.0pt 4.0pt;
	font-size:12.0pt;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.reference, li.reference, div.reference
	{mso-style-name:reference;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.subsect, li.subsect, div.subsect
	{mso-style-name:subsect;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.subsect1, li.subsect1, div.subsect1
	{mso-style-name:subsect1;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.75pt;
	margin-left:15.0pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.subsect2, li.subsect2, div.subsect2
	{mso-style-name:subsect2;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:3.75pt;
	margin-left:15.0pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:35667465;
	mso-list-template-ids:1568556154;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1
	{mso-list-id:159977721;
	mso-list-template-ids:-1018518674;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l2
	{mso-list-id:170294518;
	mso-list-template-ids:1613012496;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3
	{mso-list-id:173231100;
	mso-list-template-ids:1917599632;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4
	{mso-list-id:756245418;
	mso-list-template-ids:1662970550;}
@list l4:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l5
	{mso-list-id:827746939;
	mso-list-template-ids:1793492752;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l6
	{mso-list-id:1001545117;
	mso-list-template-ids:1453126264;}
@list l6:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l7
	{mso-list-id:2119331306;
	mso-list-template-ids:-210095380;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><![if mso 9]>
<style>
p.MsoNormal
	{margin-left:15.0pt;}
</style>
<![endif]><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white lang=EN-US link=blue vlink=purple style='tab-interval:.5in;
margin-left:15.0pt;margin-top:15.0pt;margin-right:15.0pt;margin-bottom:15.0pt'>

<div class=Section1>

<div style='border:none;border-bottom:solid windowtext 1.0pt;mso-border-bottom-alt:
solid windowtext .75pt;padding:0in 0in 0in 0in;margin-bottom:7.5pt' id=header>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
style='font-family:Arial;color:black'><a href="../index.html"></a><o:p></o:p></span></p>

<h1 align=center style='text-align:center'><span style='font-family:Arial'>Fedora
Authorization with&nbsp;XACML Policy Enforcement<o:p></o:p></span></h1>

<p style='mso-line-height-alt:15.0pt'><b><span style='font-size:16.0pt;
font-family:Arial;color:black'>&nbsp;</span></b><span style='font-family:Arial;
color:black'><o:p></o:p></span></p>

</div>

<div>

<h2 style='mso-line-height-alt:15.0pt'><span style='font-family:Arial'>Table of
Contents<o:p></o:p></span></h2>

<div>

<ol start=1 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level1 lfo1;
     tab-stops:list .5in'><span style='font-family:Arial'><a href="#INTRO">Introduction</a>
     <o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level1 lfo1;
     tab-stops:list .5in'><span style='font-family:Arial'><a href="#CONFIG">Configuring
     the XACML Authorization Module</a> <o:p></o:p></span></li>
</ol>

<ol start=2 type=1>
 <ul type=circle>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#CONFIG-ENABLE">2.1 Enabling/Disabling XACML Policy Enforcement</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#CONFIG-STORE">2.2 Configuring the Storage Locations of Policies</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#CONFIG-ACTIVATE">2.3 Activating and Loading Repository-Wide
      Policies</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#CONFIG-VALIDATE">2.4 Enabling/Disabling Policy Validation</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#CONFIG-SURROG">2.5 Configuring “Surrogate” Policies (and what are
      they?)</a><o:p></o:p></span></li>
 </ul>
</ol>

<ol start=3 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level1 lfo1;
     tab-stops:list .5in'><span style='font-family:Arial'><a href="#IMPL">Implementation
     of the Fedora Policy Enforcement Module</a> <o:p></o:p></span></li>
</ol>

<ol start=3 type=1>
 <ul type=circle>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#IMPL-PDP-PEP">3.1 Policy Determination Point (PDP) and Policy
      Enforcement Point (PEP)</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#IMPL-ALGORITHM">3.2 Understanding the XACML Policy Combining
      Algorithm</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#IMPL-DECISION">3.3 A Simplified Understanding of the Authorization
      Decision</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a href="#IMPL-PDP">3.4
      PDP Implementation Details</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a href="#IMPL-PEP">3.5
      PEP Implementation Details</a><o:p></o:p></span></li>
 </ul>
</ol>

<ol start=4 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level1 lfo1;
     tab-stops:list .5in'><span style='font-family:Arial'><a href="#ATTR">How
     to Bind User Attributes into the Fedora Policy Enforcement Module</a> <o:p></o:p></span></li>
</ol>

<ol start=4 type=1>
 <ul type=circle>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a href="#ATTR1">4.1
      Tomcat-users attributes</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a href="#ATTR2">4.2
      LDAP attributes</a><o:p></o:p></span></li>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level2 lfo1;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a href="#ATTR3">4.3
      Shibboleth attributes via an HTTP Servlet Filter</a><o:p></o:p></span></li>
 </ul>
</ol>

<ol start=5 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level1 lfo1;
     tab-stops:list .5in'><span style='font-family:Arial'><a href="#DEFAULT">Default
     Repository Policies for Fedora</a> <o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l6 level1 lfo1;
     tab-stops:list .5in'><span style='font-family:Arial'><a href="#CUSTOM">Sample
     Policies for Typical Fedora Use</a> <o:p></o:p></span></li>
</ol>

</div>

</div>

<div>

<h2 style='mso-line-height-alt:15.0pt'><a name=INTRO><span style='font-family:
Arial'>1 Introduction</span></a><span style='font-family:Arial'><o:p></o:p></span></h2>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-size:9.0pt;font-family:Arial;
color:black'>A major feature of the new Fedora security architecture is the
introduction of the <a
href="http://docs.oasis-open.org/xacml/access_control-xacml-2_0-core-spec-cd-04.pdf">eXtensible
Access Control Markup Language</a> (XACML) and an XACML-based policy
enforcement module.&nbsp;&nbsp;&nbsp; Developed by the OASIS Consortium, XACML
is an XML-based markup language to encode access control policies.&nbsp; The
policy language is flexible and enables the specification of fine-grained,
machine-readable policies that can be used to control access to Fedora web
services, Fedora digital objects, datastreams, disseminations, and
more.&nbsp;&nbsp;&nbsp; Since a policy is only worth its salt if it can be
enforced, Fedora 2.1 introduces a new Authorization module implemented as part
of the core Fedora repository service.&nbsp;&nbsp;&nbsp; The Authorization
module is built upon the <a href="http://sunxacml.sourceforge.net">Sun XACML
engine</a>.&nbsp; Each XACML policy defines: (1) a &quot;target&quot; describes
what the policy applies to (by referring to attributes of users, operations,
objects, datastreams, dates, and more), and (2) one or more &quot;rules&quot;
to permit or deny access.&nbsp; There is a <a
href="XACMLPolicyGuide.htm#POLICY-VOCAB">Fedora-specific policy vocabulary</a>
for referring Fedora operations and Fedora-specific entities within XACML
policies.&nbsp;&nbsp;&nbsp; Regarding policies, Fedora supports both
repository-wide policies (that specify broad access controls that apply to the
entire repository), and object-specific policies (that specify rules for a
single object, and can even be stored within the object in a special
datastream).&nbsp; Fedora 2.1 comes out-of-the-box with a set of <a
href="#DEFAULT">default repository-wide policies</a> that establish baseline
access controls that are equivalent to what was provided in Fedora
2.0.&nbsp;&nbsp; These default policies restrict access to the Fedora
management web service (API-M) to only the Fedora administrator, permit open
access to the Fedora access web service (API-A), and establish some other basic
controls (e.g., allow access to API-M only from localhost; restrict policy
management to administrator).&nbsp;&nbsp; In addition to the default policies
(which can be modified), any number of custom XACML policies can be written and
loaded into Fedora.&nbsp;&nbsp; For assistance in creating new policies for
your repository and for your objects, see the <a href="XACMLPolicyGuide.htm">Fedora
XACML Policy Writing Guide</a>. </span><span style='font-family:Arial;
color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>This
guide is intended to give a general overview of XACML-based Policy Enforcement
Module to support authorization in Fedora repositories.&nbsp;&nbsp;&nbsp; This
guide provides Instructions on how to configure XACML-based policy
authorization in Fedora as well as a discussion of how the Fedora Policy
Enforcement module works.&nbsp; <b><i>&nbsp;</i></b> For more information
consult the following sources:<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><span style='font-family:Arial;color:black'>Fedora
Security Architecture:</span></b><span style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'><a
href="securingrepo.html">Securing Your Repository</a> : documentation on
security options and configuring configuring user authentication sources for
Fedora repositories<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'><a
href="AuthorizationXACML.htm">Fedora XACML Policy Writering Guide</a> :
documentation for details on writing XACML policies for Fedora repositories<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><span style='font-family:Arial;color:black'>OASIS&nbsp;
(for policy writers)</span></b><span style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'><br>
<a
href="http://docs.oasis-open.org/xacml/access_control-xacml-2_0-core-spec-cd-04.pdf">OASIS
XACML Specification</a>:&nbsp; this is the official specification and a good
reference document. <br>
<br>
<a
href="http://www.oasis-open.org/committees/download.php/2713/Brief_Introduction_to_XACML.html">A
Brief Introduction to XACML</a>:&nbsp; this is nice introduction to the XACML
concepts<br>
<br>
<a href="http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=xacml">XACML
Technical Committee</a>:&nbsp;&nbsp; this home page of the technical committee
provides access to other documents on XACML<br>
<br>
<br>
<b>SUN&nbsp; (for developers)</b><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'><br>
<a href="http://sunxacml.sourceforge.net">Sun XACML Home Page</a>:&nbsp;
general information on the Sun Java reference implementation of XACML<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'><a
href="http://sunxacml.sourceforge.net/guide.html">Sun XACML Programmer Guide</a>:&nbsp;
technical details of the reference implementation<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'><a
href="http://sunxacml.sourceforge.net/javadoc/index.html">Sun XACML Javadocs</a>:&nbsp;
interface definitions of the reference implementation<br>
<i><br>
&nbsp;</i><o:p></o:p></span></p>

</div>

<h2 style='line-height:15.0pt'><a name=CONFIG><span style='font-size:14.0pt;
font-family:Arial'>2 Configuring the XACML Authorization Module</span></a><span
style='mso-bookmark:CONFIG'></span><span style='font-family:Arial'><o:p></o:p></span></h2>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black;background:white'>&nbsp;</span><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><i><span style='font-family:Arial;color:black'>Note
that to do identity-based policies (user login id or user attributes), you must
have authentication configured.&nbsp;&nbsp;&nbsp; Run fedora-setup to choose
which Fedora service interfaces will be configured for
authentication.&nbsp;&nbsp; If a policy is written that makes reference to
required (MustBePresent=&quot;true&quot;, either explicitly or by default) user
identity or attributes (Subject attributes in Policy target) and authentication
has not been configured, the policy will be evaluated as
&quot;indeterminate&quot; and the service request will fail with an
authorization exception.&nbsp;&nbsp; Be sure to enable authentication for API-A
if you intend to write policies for accessing objects based on user
identity/attributes.&nbsp; </span></i><span style='font-family:Arial;
color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>By
default, Fedora XACML-based authorization is enabled.&nbsp;&nbsp; Configuration
of the Fedora XACML-based Policy Enforcement Module is done in the Fedora
server configuration file (fedora.fcfg).&nbsp; Depicted below is the section of
the configuration file for the Authorization module that controls XACML-based
policy enforcement.<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'>&lt;module role=&quot;fedora.server.security.Authorization&quot; class=&quot;fedora.server.security.DefaultAuthorization&quot;&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;comment&gt;Builds and manages Fedora's authorization structure.&lt;/comment&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;ALLOW-SURROGATES&quot; value=&quot;false&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;REPOSITORY-POLICIES-DIRECTORY&quot; value=&quot;/fedora-xacml-policies/repository-policies&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;SURROGATE-POLICIES-DIRECTORY&quot; value=&quot;/fedora-xacml-policies/surrogate-policies&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;XACML-COMBINING-ALGORITHM&quot; value=&quot;com.sun.xacml.combine.OrderedDenyOverridesPolicyAlg&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;ENFORCE-MODE&quot; value=&quot;enforce-policies&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;POLICY-SCHEMA-PATH&quot; value=&quot;xsd/cs-xacml-schema-policy-01.xsd&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;VALIDATE-REPOSITORY-POLICIES&quot; value=&quot;true&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;VALIDATE-OBJECT-POLICIES-FROM-DATASTREAM&quot; value=&quot;false&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;VALIDATE-SURROGATE-POLICIES&quot; value=&quot;false&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'>&lt;/module&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><span style='font-family:Arial'>2<a
name=CONFIG-ENABLE>.1 Enabling/Disabling XACML Policy Enforcement</a><o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>To
enable/disable XACML policy enforcement in Fedora, use the Fedora configuration
file (fedora.fcfg).&nbsp; Whether Fedora uses XACML for authorization decisions
is controlled by the “ENFORCE-MODE” parameter in the Authorization module:<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;ENFORCE-MODE&quot; value=&quot;enforce-policies&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

</div>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>The
&quot;ENFORCE-MODE&quot; parameter can contain one of three values, with the
following meanings:<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black;background:white'>&nbsp;</span><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='text-indent:.5in;line-height:15.0pt;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:black;background:white'>enforce-policies
- enable XACML enforcement to determine whether a request is permitted or
denied</span><span style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black;background:white'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
permit-all-requests – disable XACML enforcement; PERMIT every request</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'> by default</span><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black;background:white'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
deny-all-requests -&nbsp; disable XACML enforcement; DENY every request</span><span
style='font-size:10.0pt;font-family:"Courier New";color:black'> by default</span><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>The
“enforce-policies” setting is used to enable the enforcement of XACML policies,
and is the default setting for a Fedora repository.&nbsp; The
“permit-all-requests” setting can facilitate testing code independent of
security.&nbsp; The “deny-all-requests” setting can be used to quickly shut
down access to the server, but requires a server restart to affect this.<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Tomcat
container security is, of course, still a first barrier to
authentication/authorization (i.e., Fedora's Tomcat web.xml specifies access
protection earlier than XACML.&nbsp; Tomcat container security is always in
place regardless of the setting for parameter ENFORCE-MODE.<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span><span style='font-family:
Arial;color:black'><o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><span style='font-family:Arial'>2<a
name=CONFIG-STORE>.2 Configuring the Storage Locations of Policies</a><o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Active
policies are those policies that are &quot;in play&quot; for the
repository.&nbsp; There are two places that active policies can be
stored:&nbsp; (a) in a file system location configured for the repository, or
(b) in digital objects within the special &quot;POLICY&quot;
datastream.&nbsp;&nbsp;&nbsp; It should be noted that Fedora comes
out-of-the-box with a set of default repository-wide policies.&nbsp; In
addition to these default policies,&nbsp; it is possible to create any number
of custom XACML policies for a repository and for specific digital
objects.&nbsp;&nbsp; Consult the Fedora <a href="XACMLPolicyGuide.htm">XACML
Policy Writing Guide </a>for instructions on authoring new policies and a set
of sample policies for Fedora. <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h4 style='line-height:15.0pt'><a name=STORE-REPO-WIDE></a><span
style='font-family:Arial'>a.&nbsp;Storing Repository-Wide Policies in a
Configured Location<o:p></o:p></span></h4>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Repository-wide
policies are broad policies that are intended to be in play for the entire
Fedora repository.&nbsp; By saying that these policies are “broad,” does not
mean they must be course-grained.&nbsp; Repository-wide policies can &nbsp;be
fine-grained and they can be written to control access to any Fedora API
operation, to groups of digital objects, or even to sets of specifically
identified digital objects.&nbsp; Repository-wide policies are distinguished
from object-specific policies (described below) in that <b><i>they are stored
in memory when the server is started and they are evaluated for their
applicability on every Fedora service request.</i></b>&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>In
the Authorization module section of the Fedora server configuration file
(fedora.fcfg),&nbsp; there are parameters to set the storage location for
active repository-wide policies.&nbsp;&nbsp; <b><i>The Fedora repository will
only know about policies that are stored within the configured policy directory
location.&nbsp; </i></b>Policies stored in any other location will be invisible
to the repository and will not be loaded into the repository upon server
startup!<b><i>&nbsp;&nbsp;&nbsp;&nbsp; </i></b>The storage location for active
repository-wide policies can be set by the repository administrator using the
follow parameter in Authorization module (in fedora.fcfg):&nbsp;&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;REPOSITORY-POLICIES-DIRECTORY&quot; value=&quot;/fedora-xacml-policies/repository-policies&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

</div>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>The
configuration parameters in the Authorization module provide the repository
administrator with a choice as to where XACML repository-wide policy files are
stored.&nbsp;&nbsp; If you keep the default path value,&nbsp; then the
repository-wide policy directory will be created at:&nbsp;
FEDORA_HOME/data/fedora-xacml-policies/repository-policies.&nbsp;&nbsp; You can
override this default with either a fully-qualified directory path or a
relative directory path of your choice.&nbsp;&nbsp; The policy storage location
work just like the digital object and datastream storage locations that are
also configured for the server (in fedora.fcfg).&nbsp;&nbsp; It is expected
that repository administrators appropriately protect these directories so that
they cannot be tampered with.<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><i><span style='font-family:Arial;color:black'>Default
Repository-Wide Policies</span></i></b><span style='font-family:Arial;
color:black'>:&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>It
should be noted that Fedora comes out-of-the-box with a set of default
repository-wide policies.&nbsp; The default policies are automatically copied
into the active policies storage location the first time the Fedora repository
server is started (i.e., copied into a subdirectory named
&quot;/default&quot;).&nbsp;&nbsp;<b><i> </i></b>It is recommended that changes
to the default repository-wide policies are made with extreme care.&nbsp;&nbsp;
These policies establish the baseline authorization rules for Fedora.&nbsp;
Refer to the documentation below&nbsp; on <a href="#DEFAULT">default repository
policies </a>for a description of what each policy does.&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><span style='font-family:Arial;color:black'>NOTE!
</span></b><span style='font-family:Arial;color:black'>&nbsp; <b>&nbsp;</b>Any
changes to the default policies or your own custom policies should be made in
the /default subdirectory of the configured location for repository-wide
policies.&nbsp; The original versions of the default policies are also
maintained in the internal fedora staging directory named
&quot;FEDORA_HOME/server/fedora-internal-use/&quot; from which the default
policies are copied into the configured location.&nbsp;&nbsp; <b><i>Do not edit
the policies that are stored in this internal staging directory! </i></b>&nbsp;
They are your record of how the default policies shipped with Fedora. <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><i><span style='font-family:Arial;color:black'>Custom
Repository-Wide Policies</span></i></b><span style='font-family:Arial;
color:black'>:&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>You
can create your own custom repository-wide policies and put them in the
repository-wide policy directory.&nbsp; You can also create your own
subdirectories under the repository-wide directory to organize your
policies.&nbsp;&nbsp; It is recommended that you do NOT put your custom
policies in the /default subdirectory that was created by the Fedora
server.&nbsp;&nbsp; This location is reserved for the policies that are
distributed with Fedora.&nbsp; Consult the Fedora <a href="XACMLPolicyGuide.htm">XACML
Policy Writing Guide </a>for instructions on authoring new custom policies and
to view a set of sample policies for Fedora. <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Custom
repository-wide policies can be written to deny/permit access to Fedora API
operations, to control access to groups of objects, or to control access to
objects with certain attributes under certain conditions.&nbsp;&nbsp; It should
be noted that custom repository-wide policies can be also written to address a
specific digital objects (identified by PID).&nbsp;&nbsp; This is in contrast
to storing or referencing an object-specific policy inside the digital object's
POLICY datastream (described below).&nbsp; The disadvantage of putting an
object-specific policy in the repository-policies storage location is that the
policy is unnecessarily evaluated for requests that do not pertain to the
specific digital object it is about.&nbsp;&nbsp; This is because repsoitory-wide
policies are stored in memory and are evaluated for every Fedora API
request.&nbsp; As described below, there are better places to store a policy
that pertains to a single digital object (or a small set of named digital
objects).<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h4 style='line-height:15.0pt'><span style='font-family:Arial'>b. Storing
Object-Specific Policies in a POLICY Datastream<o:p></o:p></span></h4>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>An object-specific policy can be stored inside a digital
object within the special reserved datastream whose ID is
&quot;POLICY&quot;.&nbsp;&nbsp; There are several benefits to storing
object-specific policies in the POLICY datastream.&nbsp; First, these policies
are only evaluated for those Fedora API requests that pertain to the digital
object in which the policy &quot;resides.&quot;&nbsp;&nbsp; Policies that are
stored in the POLICY datastream are not loaded into memory upon startup of the
Fedora server (as are the repository-wide policies); therefore, the POLICY
datastream approach may be a way to enhance performance in cases where a large
number of object-specific policies will exist.&nbsp;&nbsp; Another benefit is
that the POLICY datastream storage strategy may provide for easier distribution
of policy management responsibilities&nbsp; For example, authors or owners of
particular digital objects can be granted the rights to view and modify the
POLICY datastream of their objects, without having to obtain repository administrator
privileges to modify policies in a configured policy storage locations external
to a repository.<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>Unlike when an object-specific policy is placed in the
repository-wide policies directory, it is not necessary to specify the an
object PID in the target of the XACML policy target when the&nbsp; policy
resides in a POLICY datastream.&nbsp; The Fedora system will automatically make
this association during policy enforcement.&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><b><i><span style='font-family:
Arial;color:black'>Policies as stored as Inline-XML (X) or Managed-Content (M)
Datastreams</span></i></b><i><span style='font-family:Arial;color:black'>:</span></i><span
style='font-family:Arial;color:black'>&nbsp; One benefit of putting an
object-specific policy inside a digital object as a type X or M datastream is
that the policy is stored within the either in the object's XML wrapper file
(i.e., FOXML), or it is stored in the managed content datastream area of the
repository.&nbsp; In either case, the POLICY file itself is under the direct
custodianship of the Fedora repository.&nbsp;&nbsp; As such, these policies are
managed like any other X or M datastreams, and the policies become <b><i>portable</i></b>
with their parent digital objects (e.g., the polcies goes with with an object,
as datastream content, when the object is exported from the
repository).&nbsp;&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><b><i><span style='font-family:
Arial;color:black'>Policies as Externally Referenced (E) or Redirected (R)
Datastreams</span></i></b><span style='font-family:Arial;color:black'>:&nbsp;
One benefit of putting object-specific policies in the POLICY datastream in a
by-reference fashion is that multiple digital objects can point to the same
policy.&nbsp; In this case, you probably do not want to have the target of the
XACML policy make reference particular digital object PIDs.&nbsp;&nbsp;&nbsp;
In this scenario, you can store the policy external to the digital objects to
which it pertains, and store the URL of the external policy location in the E
or R type datastream.&nbsp;&nbsp; Fedora resolves such URLs at runtime, so when
the policy enforcement module needs to evaluate the XACML policy, Fedora will
automatically retrieve the policy file from its external location and pass it
on the the policy enforcement module for evaluation.&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><i><span style='font-family:Arial;color:black'>&nbsp;</span></i></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><a name=CONFIG-ACTIVATE><span style='font-family:
Arial'>2.3 Activating and Loading Repository-Wide Policies</span></a><span
style='font-family:Arial'><o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Repository-wide
policies are not considered <b><i>active</i></b> unless they are placed in the
configured storage location specified in the Authorization module configuration
(see fedora.fcfg).&nbsp;&nbsp; Once policies are placed either directly in this
directory, or within subdirectories under it, they are able to be <b><i>loaded</i></b>
by the Fedora repository server.&nbsp;&nbsp; To put new custom policies into
play, simply add them to the configured repository-wide directory, or
subdirectories within it.&nbsp;&nbsp;&nbsp; To inactivate a policy, remove it
from the directory.&nbsp; To modify an existing policies, edit the policy in
the configured policy directories (or preferably, edit in another location and
replace the existing policy in the configured policy directory).<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>To
activate and load repository-wide policies take the following steps:<o:p></o:p></span></p>

<ol start=1 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l4 level1 lfo2;
     tab-stops:list .5in'><b><span style='font-family:Arial'>Validate</span></b><span
     style='font-family:Arial'> your policies using the <a
     href="../cmd-line/index.html#validate">validate-policy</a> command line
     utility&nbsp; <i>(optional, but recommended!)</i><o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l4 level1 lfo2;
     tab-stops:list .5in'><b><span style='font-family:Arial'>Activate</span></b><span
     style='font-family:Arial'> your policies by copying them into the
     configured storage location for repository-wide policies (configured in
     the Authorization module in fedora.fcfg).&nbsp; <o:p></o:p></span></li>
</ol>

<p style='margin-left:.5in;line-height:15.0pt'><span style='font-family:Arial;
color:black'>&nbsp;<o:p></o:p></span></p>

<ol start=2 type=1>
 <ul type=circle>
  <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l4 level2 lfo2;
      tab-stops:list 1.0in'><span style='font-family:Arial'><a
      href="#STORE-REPO-WIDE">REPOSITORY-POLICIES-DIRECTORY </a>&nbsp; - put
      your custom repository-wide policies in any sub-directory under this
      configured directory<o:p></o:p></span></li>
 </ul>
</ol>

<p style='margin-left:.5in;line-height:15.0pt'><span style='font-family:Arial;
color:black'>&nbsp;<o:p></o:p></span></p>

<ol start=3 type=1>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l4 level1 lfo2;
     tab-stops:list .5in'><b><span style='font-family:Arial'>Load</span></b><span
     style='font-family:Arial'> your policies by starting the Fedora server
     (using the <a href="../cmd-line/index.html#start">fedora-start</a> command
     line utility).&nbsp; If the server is already started, run the <a
     href="../cmd-line/index.html#reload">fedora-reload-policies</a> command
     line utility.&nbsp; <o:p></o:p></span></li>
</ol>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>All
repository-wide policies are loaded into the Fedora server's memory every time
the server is started.&nbsp; For obvious performance reasons, object-specific
policies stored in the POLICY datastreams of digital objects are not
pre-loaded; instead they are loaded on an as-needed basis (i.e., when a request
for that object is made).&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'><br>
<b>WARNING: </b>It should be noted that the <b><i>first time </i></b>the Fedora
server is started, the <b><i>default </i></b>repository-wide policies are
copied into a subdirectory named &quot;/default&quot; under the repository-wide
policy storage location.&nbsp;&nbsp;To make sure this happens correctly, you
should initially start the server with the default value for the server
hostname (see &quot;fedoraServerHost&quot; in fedora.fcfg).&nbsp; The default
is 127.0.0.1 (or &quot;localhost&quot;).&nbsp;&nbsp; This initial starting of the
server as &quot;localhost&quot; is necessary to make sure that the default
XACML policies are properly configured and placed in the repository-wide policy
directory.&nbsp;&nbsp; Once the default policies are in place, you can shutdown
the server and change the hostname at any time.&nbsp; If you subsequently
change the hostname to something other than &quot;localhost&quot; you must
manually update some of the default policies to reflect the fixed IP address of
your server.&nbsp; In the following default policies, you will see the loopback
IP address of 127.0.0.1 in the policy condition:<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'><br>
<i>(1) deny-apim-if-not-localhost.xml, <br>
(2) deny-reloadPolicies-if-not-localhost.xml<br>
(3) deny-serverShutdown-if-not-localhost.xml</i>)<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Simply
add the new IP address to the policy rule as follows:<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'>&lt;Rule RuleId=&quot;1&quot; Effect=&quot;Deny&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;Condition FunctionId=&quot;urn:oasis:names:tc:xacml:1.0:function:not&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Apply FunctionId=&quot;urn:oasis:names:tc:xacml:1.0:function:or&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;Apply FunctionId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-at-least-one-member-of&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;EnvironmentAttributeDesignator AttributeId=&quot;urn:fedora:names:fedora:2.1:environment:httpRequest:clientIpAddress&quot; DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>          </span>&lt;Apply FunctionId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-bag&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>         </span><span style='mso-spacerun:yes'>   </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;127.0.0.1&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>            </span><b>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;111.22.333.4&lt;/AttributeValue&gt;</b><o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>          </span>&lt;/Apply&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;/Apply&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Apply&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;/Condition&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'>&lt;/Rule&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

</div>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span><span style='font-family:
Arial;color:black'><o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><span style='font-family:Arial'>2<a
name=CONFIG-VALIDATE>.4 Enabling/Disabling Policy Validation</a><o:p></o:p></span></h3>

<p style='line-height:15.0pt;text-autospace:none'><b><span style='font-family:
Arial;color:black'>&nbsp;</span></b><span style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>There are several parameters in the Authorization module
configuration that control whether Fedora will attempt to validate policies
against the XML schema for XACML.&nbsp;&nbsp;&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&lt;param name=&quot;POLICY-SCHEMA-PATH&quot; value=&quot;xsd/cs-xacml-schema-policy-01.xsd&quot;/&gt;<span style='mso-spacerun:yes'>    </span><o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;VALIDATE-REPOSITORY-POLICIES&quot; value=&quot;true&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;VALIDATE-OBJECT-POLICIES-FROM-DATASTREAM&quot; value=&quot;false&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;VALIDATE-SURROGATE-POLICIES&quot; value=&quot;false&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>By default all repository-wide policies will be validated by
the repository when they are loaded.&nbsp; It is up to the repository
administrator to pre-validate for object-specific and surrogate policies before
placing them in the active policy storage location. &nbsp;&nbsp; In general it
is recommended that all new policies are validated before they are put into the
active policy location.&nbsp; Use the <a href="../cmd-line/index.html#validate">validate-policy</a>
command line utility to validate an XACML policy file. A policy failing
validation would result in the following situation, according to the stated
case.<o:p></o:p></span></p>

<ul type=disc>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l1 level1 lfo3;
     tab-stops:list .5in'><span style='font-family:Arial'>repository policy:
     authorization module failure at server startup time, server not properly
     started<o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l1 level1 lfo3;
     tab-stops:list .5in'><span style='font-family:Arial'>object policy: authorization
     enforcement failure at request time, authorization denied<o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l1 level1 lfo3;
     tab-stops:list .5in'><span style='font-family:Arial'>surrogate policy:
     authorization enforcement failure at request time, authorization denied<o:p></o:p></span></li>
</ul>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>Object policies are not set to validate by default because
they are loaded dynamically at each use, and neither testing to prove adequate
performance nor caching to ensure it has been done. Surrogate policies are not
set to validate by default because surrogate support is not by default turned
on. Either of these policy validation checks can be enabled by the appropriate
fedora.fcfg setting. <o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><b><i><span style='font-family:
Arial;color:black'>&nbsp;&nbsp;</span></i></b><span style='font-family:Arial;
color:black'><o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><span style='font-family:Arial'>2<a
name=CONFIG-SURROG>.5 Configuring “Surrogate” Policies (and what are they?)</a><o:p></o:p></span></h3>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>This is an<b><i> experimental feature</i></b> provided with
Fedora 2.1 that enables a higher level application or service (e.g., a Web
front end, middleware, or other web service) to authenticate to Fedora with its
own identity, but pass along the identity of an end-user that authenticated
with the service.&nbsp;&nbsp; The higher level application or service is thus
acting as a &quot;surrogate&quot; for the ultimate end user.&nbsp;&nbsp; The surrogate
user can pass through to Fedora the identity identity of the end-user it is
representing in the HTTP request header (using the From: attribute).&nbsp; If
Fedora authenticates the identity of the service-as-surrogate, then the
identity of the ultimate end user can be used in XACML policies.&nbsp;&nbsp;
The way this is done is to create special &quot;surrogate&quot; policies that
should reside in the special surrogate policies directory configured in the
Fedora Server Configuration File (fedora.fcfg).&nbsp;&nbsp; To enable the
surrogate policy feature, you must set the ALLOW-SURROGATES parameter to
&quot;true&quot; as depicted below.&nbsp; Also note the setting for where
surrogate policies are stored, as well as the option to have the server
validate surrogate policies.<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'>&lt;module role=&quot;fedora.server.security.Authorization&quot; class=&quot;fedora.server.security.DefaultAuthorization&quot;&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;comment&gt;Builds and manages Fedora's authorization structure.&lt;/comment&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>   </span><b><span style='mso-spacerun:yes'> </span>&lt;param name=&quot;ALLOW-SURROGATES&quot; value=&quot;true&quot;/&gt;</b><o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;REPOSITORY-POLICIES-DIRECTORY&quot; value=&quot;/fedora-xacml-policies/repository-policies&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>   </span><b><span style='mso-spacerun:yes'> </span>&lt;param name=&quot;SURROGATE-POLICIES-DIRECTORY&quot; value=&quot;/fedora-xacml-policies/surrogate-policies&quot;/&gt;</b><o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;XACML-COMBINING-ALGORITHM&quot; value=&quot;com.sun.xacml.combine.OrderedDenyOverridesPolicyAlg&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;ENFORCE-MODE&quot; value=&quot;enforce-policies&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;POLICY-SCHEMA-PATH&quot; value=&quot;xsd/cs-xacml-schema-policy-01.xsd&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;VALIDATE-REPOSITORY-POLICIES&quot; value=&quot;true&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;VALIDATE-OBJECT-POLICIES-FROM-FILE&quot; value=&quot;false&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;param name=&quot;VALIDATE-OBJECT-POLICIES-FROM-DATASTREAM&quot; value=&quot;false&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'><span style='mso-spacerun:yes'>   </span><b><span style='mso-spacerun:yes'> </span>&lt;param name=&quot;VALIDATE-SURROGATE-POLICIES&quot; value=&quot;false&quot;/&gt;</b><o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='color:black'>&lt;/module&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>Given that there are policies in the surrogate-policies
directory that permit a service to act as a surrogate for and end user, <b>&nbsp;</b>then
incoming Fedora API requests are treated as if the end-user had been
authenticated by Fedora.&nbsp;&nbsp; The surrogate policies refer necessarily
to the action <b>&quot;actAsSurrogateFor&quot;</b> to determine whether the a
service with a certain identity can participate in the surrogate policy
enforcement capability.&nbsp; This attribute is defined in the Fedora XACML
vocabulary.&nbsp; Once the surrogate identify is permitted by Fedora (via
enforcement of&nbsp; a surrogate policy), then Fedora API requests can proceed
further where they will ultimately be subject to any normal repository-wide or
object-specific XACML policies that enforce policies based on actual end user
identity.&nbsp; <i>&nbsp;</i><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>Below is an example of a surrogate policy that allows a web
front-end application (whose identity is &quot;webfrontend&quot; to be
permitted by Fedora to acts as a surrogate for other end-user identities:<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&lt;?xml
version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br style='mso-special-character:
line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'><span
style='mso-tab-count:1'>  </span>&lt;Policy
xmlns=&quot;urn:oasis:names:tc:xacml:1.0:policy&quot;
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; <o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'><span
style='mso-tab-count:1'>  </span>PolicyId=&quot;permit-surrogate&quot;
RuleCombiningAlgId=&quot;urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable&quot;&gt;<br
style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'><span
style='mso-tab-count:1'>  </span>&lt;Description&gt;note that other policies
may provide exceptions to this broad <o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'><span
style='mso-tab-count:1'>  </span>policy&lt;/Description&gt;<br
style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;
&lt;Target&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;Subjects&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;Subject&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;SubjectMatch
MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<br
style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'><span
style='mso-tab-count:1'>  </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;webfrontend&lt;/AttributeValue&gt;<br
style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'><span
style='mso-tab-count:1'>  </span>&lt;SubjectAttributeDesignator
DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot; <o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'><span
style='mso-tab-count:1'>  </span>AttributeId=&quot;fedoraRole&quot;
MustBePresent=&quot;false&quot;/&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;/SubjectMatch&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;/Subject&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;/Subjects&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;Resources&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;AnyResource/&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;/Resources&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;Actions&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;Action&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;ActionMatch
MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<br
style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'><span
style='mso-tab-count:1'>  </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;urn:fedora:names:fedora:2.1:<b>action:id-actAsSurrogateFor</b>&lt;/AttributeValue&gt;<br
style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'><span
style='mso-tab-count:1'>  </span>&lt;ActionAttributeDesignator
DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot; <o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'><span
style='mso-tab-count:1'>  </span>AttributeId=&quot;urn:fedora:names:fedora:2.1:<b>action:id</b>&quot;/&gt;<br
style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;/ActionMatch&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;/Action&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'>&nbsp;&nbsp;&nbsp;
&lt;/Actions&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'><span
style='mso-tab-count:1'>  </span>&lt;/Target&gt;<br style='mso-special-character:
line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'><span
style='mso-tab-count:1'>  </span>&lt;Rule RuleId=&quot;1&quot;
Effect=&quot;Permit&quot;/&gt;<br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]><o:p></o:p></span></p>

<p style='line-height:15.0pt;background:#DDDDFF;text-autospace:none'><span
style='font-family:"Lucida Console";mso-bidi-font-family:Arial;color:black'><span
style='mso-tab-count:1'>  </span>&lt;/Policy&gt;<o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><b><span style='font-family:
Arial;color:black'>NOTE</span></b><span style='font-family:Arial;color:black'>!&nbsp;
<i>Since surrogate policies is an <b>experimental feature</b> with Fedora 2.1
it is not fully guaranteed yet.&nbsp; However, please contact the Fedora team (<a
href="http://www.fedora.info/about/contact.shtml">http://www.fedora.info/about/contact.shtml</a>)
if you would like to experiment with this feature.</i><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h2 style='mso-line-height-alt:15.0pt;text-autospace:none'><a name=IMPL><span
style='font-family:Arial'>3 Implementation of the Fedora Policy Enforcement
Module</span></a><span style='font-family:Arial'><o:p></o:p></span></h2>

<h2 style='mso-line-height-alt:15.0pt;text-autospace:none'><span
style='font-family:Arial'>&nbsp;<o:p></o:p></span></h2>

<h3 style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial'>3<a name=IMPL-PDP-PEP>.1&nbsp; Policy Determination Point (PDP) and
Policy Enforcement Point (PEP)</a><o:p></o:p></span></h3>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>According to the OASIS XACML specification, “an application
functions in the role of the Policy Enforcement Point (PEP) if it guards access
to a set of resources and asks the Policy Determination Point (PDP) for an
authorization decision.&nbsp; The PEP MUST abide by the authorization decision
in the following way:&nbsp; A PEP SHALL allow access to the resource only if a
valid XACML response of “Permit” is returned by the PDP.&nbsp; The PEP SHALL deny
access to the resource in all other cases.&nbsp; An XACML response of “Permit”
SHALL be considered valid only if the PEP understands all of the obligations
contained in the response.”&nbsp;&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>The Fedora Policy Enforcement Module fulfills the
responsibilities of both the PEP, except that for 2.1, obligations are ignored.
(But neither are any coded in the default policies.)&nbsp; The Fedora module
wraps the Sun XACML implementation of the PDP.&nbsp;&nbsp; Fedora module also
implements custom attribute finders and a custom PEP.<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>The
PDP determines the set of policies that are applicable to any given Fedora
service request.&nbsp; Remember the PDP determines whether a policy is
applicable by comparing the Subject/Resource/Action attribute designations in a
Policy Target to the context of an incoming Fedora service request (i.e.,
attributes that describe the Fedora service request, the user/subject, the
desired object/datastream/dissemination, and the runtime
environment).&nbsp;&nbsp; &nbsp;Repository-wide policies are always in play and
will be evaluated by the PDP to determine whether they are applicable to the
particular incoming Fedora service request.&nbsp; Object-specific policies if
the incoming request refers to an object by its PID and there exists an
object-specific policy mentioning that PID.&nbsp; <b><i>PDP makes the decision
of deny/permit/indeterminate, and then the PEP makes sure to enforce this
decision for the incoming Fedora API request.</i></b><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><i><span style='font-family:Arial;color:black'>NOTE:&nbsp;
</span></i><i><span style='font-size:9.0pt;font-family:Arial;color:black'>To
quiet the Sun XACML engine's INFO messages, a logging.properties file is
included with the Fedora distribution, &nbsp;edited to print only SEVERE
messages to the console. Fedora then starts Java using that logging.properties
file. &nbsp;The original file, as distributed with JDK 1.4.2.8, prints INFO
(and more severe) messages, making the console a bit &nbsp;chatty.&nbsp; To
revert to the original logging behavior, edit fedora-start.bat (Windows) or
fedora.sh (Unix), and remove the logging.properties from the java vm arguments
(see -D flags).</span></i><span style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><a name=IMPL-ALGORITHM><span style='font-family:
Arial'>3.2&nbsp; Understanding the XACML Policy Combining Algorithm</span></a><span
style='font-family:Arial'><o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Policy
writers must understand the interaction effect of multiple XACML policies that
are in scope for any particular action.&nbsp; The Fedora configuration file
(fedora.fcfg) sets the policy combining algorithm that will be used by the
Policy Enforcement Module in evaluating sets of policies.&nbsp; In the the Fedora
server configuration file (fedora.fcfg) note the following parameter in the
section for the Authorization module::<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>&lt;param name=&quot;XACML-COMBINING-ALGORITHM&quot; value=&quot;com.sun.xacml.combine.OrderedDenyOverridesPolicyAlg&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

</div>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>This
parameter sets the XACML policy combining algorithm that controls how the
Fedora Policy Enforcement Module will deal with multiple policies that may be
applicable to a Fedora service request.&nbsp; &nbsp;The default value in Fedora
is the “Ordered Deny Overrides” policy combining algorithm.&nbsp; It allows a
single evaluation of <b><i>deny</i></b> <b><i>to take precedence</i></b> over
any number of permit, not applicable or indeterminate results.&nbsp; Note that
this uses the regular Deny Overrides implementation since it is also
ordered.&nbsp;&nbsp; Consult the OASIS and Sun XACML documentation for a
description of alternative combining algorithms.&nbsp; Note that the default
policies assume and require this algorithm. Generally policies are developed
with an algorithm in mind. <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>In
the PDP, policies are matched based on their applicability to an incoming
service request.&nbsp;&nbsp; All policies that are applicable are combined
programmatically and dynamically per request into a PolicySet.&nbsp; To
estimate the number of policies that may be in the PolicySet for a given
service request, consider N to be the number of policies configured in Fedora’s
&nbsp;repository-wide policy storage location.&nbsp; Then we have the following
possible number of policies in a PolicySet for the PDP to consider:<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>N :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # of policies if a service
request <b><i>does not refer to a particular digital object</i></b><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>N :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # of policies if a service
request <b><i>refers to an</i></b> <b><i>object,</i></b> <b><i>but there is no
object-specific policy for that object</i></b><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>N+1:&nbsp;&nbsp; # of policies if a service request <b><i>refers
to an</i></b> <b><i>object that has an object-specific policy datastream, but
has no object-specific policy in the object policies directory</i></b><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>N+1:&nbsp;&nbsp; # of policies if a service request <b><i>refers
to an</i></b> <b><i>object that has an object-specific policy in the object
policies directory, but has no object-specific policy datastream</i></b><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>N+2:&nbsp;&nbsp; # of policies if a service request<b><i>
refers to an</i></b> <b><i>object that has an object-specific policy datastream
and a policy in the object-policies directory</i></b><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><a name=IMPL-DECISION><span style='font-family:
Arial'>3.3 A Simplified Understanding of the Authorization Decision</span></a><span
style='font-family:Arial'><o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><i><span style='font-family:Arial;color:black'>For
an incoming service request to succeed, there must be an explicit permit and
the absence of a deny;&nbsp; the absence of a deny is not enough to permit an
action</span></i></b><i><span style='font-family:Arial;color:black'> </span></i><span
style='font-family:Arial;color:black'>&nbsp; By default, if any of the
applicable policies in a Policy Set yield a deny, the requesting subject will
be denied access, even if some other policy permitted the action.&nbsp; In
other words, deny will prevail over permit.&nbsp;&nbsp; Also, if there is a
policy in the set that is evaluated as &quot;Indeterminate,&quot; then the
result of that policy evaluation will be considered a deny.&nbsp; A policy can
be evaluated as Indeterminate if there was an error during policy
evaluation.&nbsp; Also, a policy can be evaluated as Indeterminate if there is
a required attribute specified in the policy that did not exist in the context
of the incoming requests.&nbsp;&nbsp; See the section of <a
href="#POLICY-OPT-ATTRS">Required vs. Optional Attributes</a> for more
details.&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>For
the purposes of a simple understanding of the Fedora Policy Enforcement module,
things work like this:<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><i><span style='color:black'>&nbsp;NOTE:<span style='mso-spacerun:yes'>  </span></span></i><span
style='color:black'>=0<span style='mso-spacerun:yes'>  </span><i>means NO policy in a policy set evaluated to that result; <o:p></o:p></i></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><i><span style='color:black'><span style='mso-spacerun:yes'>        </span></span></i><span
style='color:black'>=1<span style='mso-spacerun:yes'>  </span><i>means one or more policies in a policy set evaluated to that result</i><o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>========= POLICY SET RESULTS =======<span style='mso-spacerun:yes'>        </span>=== FINAL DECISION ===<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><o:p>&nbsp;</o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>DENY=0<span style='mso-spacerun:yes'>   </span>INDETERMINATE=0<span style='mso-spacerun:yes'>    </span>PERMIT=0<span style='mso-spacerun:yes'>   </span></span><span
style='font-family:Wingdings;color:black'>è</span><span style='color:black'><span style='mso-spacerun:yes'>     </span>result is DENY<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>DENY=1<span style='mso-spacerun:yes'>   </span>INDETERMINATE=0<span style='mso-spacerun:yes'>    </span>PERMIT=0<span style='mso-spacerun:yes'>   </span></span><span
style='font-family:Wingdings;color:black'>è</span><span style='color:black'><span style='mso-spacerun:yes'>     </span>result is DENY<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>DENY=1<span style='mso-spacerun:yes'>   </span>INDETERMINATE=0<span style='mso-spacerun:yes'>    </span>PERMIT=1<span style='mso-spacerun:yes'>   </span></span><span
style='font-family:Wingdings;color:black'>è</span><span style='color:black'><span style='mso-spacerun:yes'>     </span>result is DENY<span style='mso-spacerun:yes'>  </span>(denial trumps permit)<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>DENY=0<span style='mso-spacerun:yes'>   </span>INDETERMINATE=0<span style='mso-spacerun:yes'>    </span>PERMIT=1<span style='mso-spacerun:yes'>   </span></span><span
style='font-family:Wingdings;color:black'>è</span><span style='color:black'><span style='mso-spacerun:yes'>     </span>result is <b>PERMIT<o:p></o:p></b></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>DENY=0<span style='mso-spacerun:yes'>   </span>INDETERMINATE=1<span style='mso-spacerun:yes'>    </span>PERMIT=1<span style='mso-spacerun:yes'>   </span></span><span
style='font-family:Wingdings;color:black'>è</span><span style='color:black'><span style='mso-spacerun:yes'>     </span>result is DENY<span style='mso-spacerun:yes'>  </span>(indeterminate is treated as denial which trumps permit)<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'>DENY=0<span style='mso-spacerun:yes'>   </span>INDETERMINATE=1<span style='mso-spacerun:yes'>    </span>PERMIT=0<span style='mso-spacerun:yes'>   </span></span><span
style='font-family:Wingdings;color:black'>è</span><span style='color:black'><span style='mso-spacerun:yes'>     </span>result is DENY<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<h2 style='mso-line-height-alt:15.0pt'><span style='font-family:Arial'>&nbsp;<o:p></o:p></span></h2>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Put
another way... assuming the default policy combining algorithm for Fedora is
&quot;Deny Overrides&quot;, an action is Permitted or Denied depending on the
evaluation of the various policies, as follows:<br>
&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><span style='font-family:Arial;color:black'>Permit
requires --ALL-- of the following conditions to be TRUE:</span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<ul type=disc>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l0 level1 lfo4;
     tab-stops:list .5in'><span style='font-family:Arial'>at least one policy
     was evaluated to Permit the action<o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l0 level1 lfo4;
     tab-stops:list .5in'><span style='font-family:Arial'>NO policy must
     evaluate to explicitly Deny the action<o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l0 level1 lfo4;
     tab-stops:list .5in'><span style='font-family:Arial'>NO policy must
     evaluate as Indeterminate for the action<o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l0 level1 lfo4;
     tab-stops:list .5in'><span style='font-family:Arial'>NO error or unknown
     result is returned by the Sun XACML engine<o:p></o:p></span></li>
</ul>

<p style='line-height:15.0pt'><b><span style='font-family:Arial;color:black'>Deny
only requires --ONE-- of the following conditions to be TRUE:</span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<ul type=disc>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l5 level1 lfo5;
     tab-stops:list .5in'><span style='font-family:Arial'>at least one policy
     was evaluated to explicitly Deny the action<o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l5 level1 lfo5;
     tab-stops:list .5in'><span style='font-family:Arial'>at least one policy
     was evaluated to be Indeterminate for the action<o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l5 level1 lfo5;
     tab-stops:list .5in'><span style='font-family:Arial'>the Sun XACML engine
     returned a unknown result (an error or a return value that is not in the
     XACML specification)<o:p></o:p></span></li>
</ul>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><a name=IMPL-PDP><span style='font-family:Arial'>3.4&nbsp;
PDP Implementation Details</span></a><span style='font-family:Arial'><o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
style='font-family:Arial;color:black'>We can understand the results of the
PDP's evaluation of a policy set&nbsp;from three perspectives:&nbsp; (1) the
Sun XACML engine, (2) the Fedora wrapper of Sun XACML, and (3) the bottom line
outcome.<o:p></o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
style='font-family:Arial;color:black'>(1)&nbsp; PDP (Sun XACML&nbsp;engine
perspective):&nbsp;&nbsp;</span></b><span style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>The
Sun XACML engine, which underlies the Fedora Policy Enforcement Module,&nbsp;
will evaluate a Policy Set and return a decision.&nbsp;&nbsp; Refer to the <a
href="http://docs.oasis-open.org/xacml/access_control-xacml-2_0-core-spec-cd-04.pdf">OASIS
XACML Specification</a> and the <a href="http://sunxacml.sourceforge.net">Sun
XACML documentation</a> for details.&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>In
making its authorization decision, the Sun XACML engine will return a single
result from its evaluation of a Policy.&nbsp; The result will be one of the
following:<o:p></o:p></span></p>

<ul type=disc>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l7 level1 lfo6;
     tab-stops:list .5in'><b><span style='font-family:Arial'>Permit</span></b><span
     style='font-family:Arial'> - returned if a policy rule was applicable and
     thus it returned its permit effect.<o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l7 level1 lfo6;
     tab-stops:list .5in'><b><span style='font-family:Arial'>Deny</span></b><span
     style='font-family:Arial'> - returned if a policy rule was applicable and
     thus returned its denial effect.<o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l7 level1 lfo6;
     tab-stops:list .5in'><b><span style='font-family:Arial'>Indeterminate</span></b><span
     style='font-family:Arial'> - returned if an attribute value that was
     needed to evaluate a rule could not be found, or another error prevented
     processing.<o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l7 level1 lfo6;
     tab-stops:list .5in'><b><span style='font-family:Arial'>NotApplicable</span></b><span
     style='font-family:Arial'> - returned if no rule applied and so no effect
     could be returned.<o:p></o:p></span></li>
</ul>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
style='font-family:Arial;color:black'>Given the default policy combining
algorithm of&nbsp; &quot;Ordered Deny Overrides,&quot; the PDP will make its
final decision for a policy set such that <b>&nbsp;DENY</b> will prevail over
PERMIT.&nbsp;&nbsp; If one or more policies evaluate to Deny, Sun XACML gives a
verdict of DENY.&nbsp; If one or more policies evaluate to Indeterminate, and
no policies evaluate to Deny, the verdict is INDETERMINATE.&nbsp; If one or
more policies evaluate to Permit, and no policies evaluate to either Deny or
Indeterminate, the verdict is PERMIT.&nbsp; If one or more policies evaluate to
NotApplicable, and no policies evaluate to Permit or Deny or Indeterminate, the
verdict is NOTAPPLICABLE.&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
style='font-family:Arial;color:black'>(2)&nbsp; PEP (Fedora
wrapper&nbsp;perspective):&nbsp;&nbsp;&nbsp;</span></b><span style='font-family:
Arial;color:black'><o:p></o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>The
Fedora wrapper respects the verdict of the Sun XACML PDP, which should usually
be PERMIT or DENY, given our default set of policies.&nbsp; But, for safety,
the Fedora wrapper code imposes a DENY result in any of several extraordinary
cases:&nbsp; (1) if somehow Sun XACML returned an unexpected final result of
Indeterminate or NotApplicable, perhaps due to a policy written incorrectly,
(2) if Sun XACML returned no result at all, (3) if Sun XACML returned a result
which is not defined by OASIS XACML or Sun XACML standards (the sunxacml Java
interface uses int to code the results, so sunxacml could return bad results),
or (4) if authorization processing results in a exception being thrown.<o:p></o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
style='font-family:Arial;color:black'>3)&nbsp; Combined (Bottom line
perspective):&nbsp; </span></b><span style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>As a
rule, a policy set evaluates to PERMIT when at least one policy in the set
evaluates to Permit and no policies evaluating to Deny or Indeterminate.&nbsp;
Otherwise, the policy set evaluates to DENY.&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Specifically:<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>a)
DENY occurs when there is at least one policy that evaluates to Deny or an
Indeterminate.<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>b)
DENY occurs if no policy evaluates to Permit.&nbsp; A DENY also occurs in
several exceptional situations:<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>a)
DENY occurs when no policies were found to be applicable (all evaluate to
NotApplicable) or the related case of there being no policies at all configured
with Fedora<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>b)
DENY occurs when errors occurred during authorization processing, including no
or bad results obtained.<br>
&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><a name=IMPL-PEP><span style='font-family:Arial'>3.5&nbsp;
Fedora PEP Implementation Details</span></a><span style='font-family:Arial'><o:p></o:p></span></h3>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>Fedora's Policy Enforcement Point (PEP) builds a minimal
request for the Sun XACML engine to evaluate.&nbsp; One job of the Fedora PEP
is to gather up all of the Subject/Resource/Action/Environment attributes that
are relevant for an incoming service requests.&nbsp;&nbsp; The values of this
attributes are the key to determining what policies are in scope for an
incoming service request.&nbsp;&nbsp; To gather up all relevant
attributes,&nbsp; the Fedora PEP has two custom &quot;attribute finder&quot;
modules that interact with the Sun XACML engine. <o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l2 level1 lfo7;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Arial;color:black'>The <b>ContextAttributeFinderModule</b>
has the job of obtaining attributes that are stored in the enhanced Fedora
Context object that is associated with an incoming Fedora service
request.&nbsp;&nbsp;&nbsp; Attributes that originate with an incoming service
requests can be Subject attributes (i.e., attributes of the requesting
user/agent), Action attributes (i.e., the identity of the Fedora API operation
that is the basis of the request), Resource attributes (i.e.,&nbsp; attributes
that identify specific objects/datastreams/disseminations that are being
requested, and Environment attributes (i.e., attributes that describe the
runtime environment of the incoming request, like the current date/time or the
server IP address).&nbsp;&nbsp; It will honor a callback, even for an attribute
which hasn't been explicitly coded, so can provide arbitrary attributes (e.g.,
from LDAP lookup in a JAAS login module, from Shibboleth via a servlet
filter).&nbsp; [There are a few attributes which it explicitly doesn't serve,
to prevent stack overflow on improper recursion, or because the attributes are
known to be provided in the xacml request itself.]<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l2 level1 lfo7;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Arial;color:black'>The <b>ResourceAttributeFinderModule</b>
has the job of obtaining all relevant attributes about Fedora resources (i.e.,
digital objects, datastreams, and disseminations) for resources that are in
scope for an incoming request.&nbsp;&nbsp; While a few attributes of a resource
are picked up from the incoming request itself (typically, the identity of a
resource like a PID or a datastream Id), the ResourceAttributeFinderModule gets
all other attributes about such resources by introspecting on actual digital
objects in the repository.&nbsp; <o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;line-height:15.0pt;mso-list:l2 level1 lfo7;
tab-stops:list .5in;text-autospace:none'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-fareast-font-family:Symbol;mso-bidi-font-family:Symbol;color:black'><span
style='mso-list:Ignore'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:Arial;color:black'>The
ContextAttributeFinderModule supplies environment values, named into the Fedora
XACML URN namespace. An <b>EnvironmentAttributeFinderModule</b> may be added
for full compliance with XACML requirement that environment attributes be
serviced which are named into its namespace XACML's namespace itself. <o:p></o:p></span></p>

<h2 style='mso-line-height-alt:15.0pt'><span style='font-family:Arial'>&nbsp;<o:p></o:p></span></h2>

<h2 style='mso-line-height-alt:15.0pt'><a name=ATTR><span style='font-family:
Arial'>4 How to Bind User Attributes into the Fedora Policy Enforcement Module</span></a><span
style='font-family:Arial'><o:p></o:p></span></h2>

<p style='line-height:15.0pt'><b><span style='font-family:Arial;color:black'>&nbsp;</span></b><span
style='font-family:Arial;color:black'>The availability of user identity and attributes
depends on the authentication configuration option selected for the
repository.&nbsp;&nbsp; Refer to the <a href="securingrepo.html#AUTHN">Authentication
and User Attributes</a> section of the <a href="securingrepo.html">Securing
Your Repository</a> guide for information on authentication configuration
options.&nbsp;&nbsp;&nbsp;&nbsp; In terms of understanding what user attributes
can be referenced for Subjects in an XACML policy, you must first know what the
sources of authentication information are for the repository.&nbsp;&nbsp;&nbsp;&nbsp;
The Fedora XACML-based Policy Enforcement module will automatically be able to
obtain attributes from one or more of following authentication sources when
they are configured as described in <a href="securingrepo.html#AUTHN">Authentication
and User Attributes</a>.<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><a name=ATTR1><span style='font-family:Arial'>4.1&nbsp;
Tomcat-users attributes</span></a><span style='font-family:Arial'><o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>In
Fedora, XACML policies can refer to user identity and role information that is
specified within the Tomcat-users file.&nbsp;&nbsp; This file is part of the
Tomcat configuration files and is auto-generated from the
tomcat-user_fedoraTemplate.xml file. It contains username and password
information about &quot;authenticated&quot; users. Roles can also be assigned
to user entries. These roles can then be used as attributes in related XACML
policies.<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>By
default, the template contains the following users, passwords, and roles:<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'><pre style='line-height:15.0pt;
background:#DDDDFF'><span style='color:black'><o:p>&nbsp;</o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;tomcat-users&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;user name=&quot;#1&quot; password=&quot;#2&quot; roles=&quot;fedoraRole=administrator&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;user name=&quot;fedoraIntCallUser&quot; password=&quot;changeme&quot; roles=&quot;fedoraRole=fedoraInternalCall-1&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;user name=&quot;surrogate64&quot; password=&quot;surrogate64&quot; roles=&quot;webfrontend&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;user name=&quot;testuser1&quot; password=&quot;testuser1&quot; roles=&quot;fedoraRole=professor&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;user name=&quot;testuser2&quot; password=&quot;testuser2&quot; roles=&quot;fedoraRole=researcher&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;user name=&quot;testuser3&quot; password=&quot;testuser3&quot; roles=&quot;fedoraRole=student&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;user name=&quot;testuser4&quot; password=&quot;testuser4&quot; roles=&quot;fedoraRole=visitor&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;user name=&quot;guest&quot; password=&quot;&quot; roles=&quot;&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;/tomcat-users&gt;<o:p></o:p></span></pre></div>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Two
aspects of tomcat-users use need pointing out.&nbsp; User roles are normally
defined in Tomcat-users as &lt;user .....
roles=&quot;value1,value2,value3&quot;/&gt;,&nbsp; where a user can have
multiple roles, and each role name is separated by a comma.&nbsp;&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><o:p>&nbsp;</o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;user name=&quot;testuser2&quot; password=&quot;testuser2&quot; <b>roles=&quot;someRole,someOtherRole&quot;</b>/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Fedora
allows an enhancement of this specification of roles which allows each role <b><i>value</i></b>
to itself be a name-value pair - essentially making each role value an
attribute/value string.&nbsp; This is a simple concept that does not break the
normal workings of Tomcat, but conveniently permits more meaning user attribute
information to be recorded.&nbsp; The reason for doing this is to allow user
attributes (attributeName=attributeValue) to be recorded in Tomcat-users in such
a way that such attributes can be later used inside XACML policies.&nbsp;&nbsp;
The basic idea is that each Tomcat role <b><i>value</i></b> is just a string,
and as such, there is no reason we can't embed an equal sign within such a
string.&nbsp;&nbsp; Thus, within the the &quot;roles=&quot; part of the user
element in Tomcat-users, we can put a series of inner name/value pairs as in
the following example:&nbsp; <o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><o:p>&nbsp;</o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;user name=&quot;testuser2&quot; password=&quot;testuser2&quot; roles=&quot;<b>someAttribute=xyz</b>,<b>fedoraRole=researcher</b>&quot;/&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-tab-count:1'>  </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>The
above example indicates that the user has two attributes (an attribute named<b>
&quot;someAttriibute&quot;</b> whose value is <i>xyz</i>, and an attribute
named<b> &quot;fedoraRole&quot;</b> whose value is <i>researcher</i>).&nbsp;
These attribute names can be used in SubjectAttributeDesignator specifications
in XACML policies and the values can be used in AttributeValue specifications
in policies.&nbsp;&nbsp; Below is a snippet of an XACML policy that refers to
attributes from Tomcat-users (refer to the <a href="XACMLPolicyGuide.htm">Fedora
XACML Policy Guide</a> for more info on policy syntax):<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;Subjects&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Subject&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;SubjectMatch MatchId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-equal&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;<b>administrator</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>        </span>&lt;SubjectAttributeDesignator AttributeId=&quot;<b>fedoraRole</b>&quot; MustBePresent=&quot;false&quot; <o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>              </span>DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>      </span>&lt;/SubjectMatch&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Subject&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;/Subjects&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><a name=ATTR2><span style='font-family:Arial'>4.2&nbsp;
LDAP attributes</span></a><span style='font-family:Arial'><o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>In
Fedora, XACML policies can refer to user attribute names and values that are
registered in an LDAP that is configured with Fedora's Tomcat.&nbsp;&nbsp;
Refer to the <a href="securingrepo.html#AUTHN">Authentication and User
Attributes</a> section of the <a href="securingrepo.html">Securing Your
Repository</a> guide for information on authentication configuration
options.&nbsp;&nbsp; Given that an LDAP is properly configured with Fedora, the
Fedora XACML-based Policy Enforcement module will be able to access LDAP user
attributes, which means that you can refer to LDAP attributes in reference to a
Subject in a policy, as shown in the following XACML snippet (refer to the <a
href="XACMLPolicyGuide.htm">Fedora XACML Policy Guide</a> for more info on
policy syntax)::<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<div style='border:solid black 1.0pt;mso-border-alt:solid black .75pt;
padding:4.0pt 4.0pt 4.0pt 4.0pt;margin-left:3.75pt;margin-top:3.75pt;
margin-right:3.75pt;margin-bottom:3.75pt'>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<pre style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;Rule RuleId=&quot;1&quot; Effect=&quot;Deny&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;Condition FunctionId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-at-least-one-member-of&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>       </span>&lt;SubjectAttributeDesignator DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot; AttributeId=&quot;<b>ou</b>&quot;/&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>       </span>&lt;Apply FunctionId=&quot;urn:oasis:names:tc:xacml:1.0:function:string-bag&quot;&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>          </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;<b>Lb-Info Technology</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>          </span>&lt;AttributeValue DataType=&quot;http://www.w3.org/2001/XMLSchema#string&quot;&gt;<b>Lb-Univ Librarian-General</b>&lt;/AttributeValue&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>       </span>&lt;/Apply&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>    </span>&lt;/Condition&gt;<o:p></o:p></span></pre><pre
style='line-height:15.0pt;background:#DDDDFF'><span style='color:black'><span style='mso-spacerun:yes'>  </span>&lt;/Rule&gt;<o:p></o:p></span></pre>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt;
background:#DDDDFF'><span style='font-family:"Lucida Console";mso-bidi-font-family:
Arial;color:black'><span style='mso-spacerun:yes'>      </span><o:p></o:p></span></p>

</div>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>In the above example, the SubjectAttributeDesignator refers
to an LDAP attribute name (&quot;ou&quot;), which refers to the university
organizational department that a user belongs to.&nbsp; The policy rule applies
a function to set up the condition that the value of the &quot;ou&quot;
attribute must be one of the listed values (&quot;Lb-Info Technology&quot; or
Lb-Univ Librarian-General&quot;).&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><a name=ATTR3><span style='font-family:Arial'>4.3&nbsp;
Shibboleth attributes via an HTTP Servlet Filter</span></a><span
style='font-family:Arial'><o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'>&nbsp;</span><span style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>There are cases when an application may obtain authenticated
user attributes in an application or service layer outside the context of the
Fedora repository service.&nbsp; Fedora provides a simple means of getting
these attributes into the Fedora repository service so they can be used by the
Fedora XACML policy enforcement module.&nbsp; To support the ability for
upstream applications or services to send these user attributes into a
repository, Fedora will recognize a special HTTP servlet request attribute
named after the value of static final String constant
fedora.server.Context.FEDORA_AUX_SUBJECT_ATTRIBUTES.<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>The Fedora repository service will automatically look for an
HTTP servlet request attribute named after this constant.&nbsp; The Fedora code
now takes a request attribute found under that name, as a Map giving name and
values of subject attributes. Currently, name must be a String and this is
unlikely to change. Value must be a String, and later this might be relaxed to
include String[], to allow&nbsp; attributes with multiple values.&nbsp; Other
types of value are not serviced. The effect of having a key =&gt; value pair
&quot;a&quot; =&gt; &quot;b&quot; in the Map&nbsp; is the same as having a
Tomcat role &quot;a=b&quot;, with the exception that the effect of having the
same attribute key redefined both places is right now undefined.&nbsp; So your
servlet filter needs only create the map and populate it, and put it into an
HTTP servlet request as attribute named after
fedora.server.Context.FEDORA_AUX_SUBJECT_ATTRIBUTES.&nbsp; Fedora will
then&nbsp;look for it, and use the attributes in XACML-based
authorization.&nbsp; <o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>This approach was initially developed to support the
OhioLink <a href="http://drc-dev.ohiolink.edu/browser/fedora-shib-filter/trunk/">Shibboleth
servlet filter </a>that will be available to the Fedora community from the
OhioLink implementation.&nbsp; Although full Shibboleth integration with Fedora
will be in future releases of Fedora, the ability to send attributes into
Fedora via a servlet filter is a way to get started with using
Shibboleth-acquired attributes in Fedora XACML policy enforcement.&nbsp; It
should be noted that this means of getting attributes into Fedora can be used
with any subject attribute source (i.e., it remains source-neutral and doesn't
favor Shibboleth or any other particular scheme). <o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><span style='font-size:14.0pt;font-family:
Arial;color:black'>&nbsp;</span></b><span style='font-family:Arial;color:black'><o:p></o:p></span></p>

<h2 style='mso-line-height-alt:15.0pt'><a name=DEFAULT><span style='font-family:
Arial'>5 Default Repository Policies for Fedora</span></a><span
style='font-family:Arial'><o:p></o:p></span></h2>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><span style='font-family:Arial'>5.1 Default
Access Control Policies<o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>out-of-the-box,
the Fedora repository will have a default set of access control policies that
provide for a highly restricted management service (API-M), an open access
service&nbsp; (API-A), and an open OAI provider service.&nbsp;&nbsp; The
default access control policies establish the same level of out-of-the-box
security on the repository that was previously configured for Fedora 2.0
release; however, as of Fedora 2.1 these basic access controls are now specified
as XACML policies.&nbsp;&nbsp; The default access control policies can be found
within the Fedora software distribution in the following directory: </span><span
style='font-family:"Courier New";color:black'>&nbsp;</span><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><span style='font-family:"Courier New";
color:black'>FEDORA_HOME/data/fedora-xacml-policies/repository-policies/default</span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><i><span style='font-family:Arial;color:black'>The
first time the Fedora repository server is started, these policies will be
automatically copied into the official <a href="#CONFIG-STORE">repository-wide
policy storage location </a>that was specified in the Fedora configuration file
(fedora.fcfg).&nbsp; The policies are activated once they are copied into this
location. </span></i><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:1.5pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>Service</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=260 style='width:195.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp;XACML Policy File</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp; Policy Description</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>1<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>any</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=260 style='width:195.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/default/repository-wide/permit-anything-to-administrator.xml">permit-anything-to-administrator.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>This is a
  &quot;positive policy&quot; that permits the Fedora administrator to have
  access to any operation on any Fedora repository service (API-M, API-A, OAI,
  RISearch).&nbsp; By default the Fedora administrator is configured in the
  default Tomcat user credentials file (tomcat-users.xml).</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>2<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>API-M</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=260 style='width:195.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/default/repository-wide/deny-apim-if-not-localhost.xml">deny-apim-if-not-localhost.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>This is a
  &quot;negative policy&quot; that denies access to API-M operations that are
  not made from the IP address of the machine on which the Fedora repository is
  running on.&nbsp;&nbsp; In other words, the policy will not allow API-M
  requests from hosts other than &quot;localhost.&quot;</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>3<o:p></o:p></span></p>
  </td>
  <td width=64 style='width:48.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>API-A</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=260 style='width:195.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/default/repository-wide/permit-apia-unrestricted.xml">permit-apia-unrestricted.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>This is a
  &quot;positive policy&quot; that permits unrestricted access to API-A.&nbsp;
  In other words, API-A operations are completely open for use by any
  user/agent.</span><span style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;mso-yfti-lastrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4<o:p></o:p></span></p>
  </td>
  <td width=59 style='width:44.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>OAI</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=423 style='width:317.25pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/default/repository-wide/permit-oai-unrestricted.xml">permit-oai-unrestricted.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>This is a
  &quot;positive policy&quot; that permits unrestricted access to the default
  OAI provider interface to the Fedora repository.&nbsp; In other words,
  OAI-PMH operations are completely open for use by any user/agent.&nbsp;
  (Note, this does not control access to the stand-alone PROAI service that is
  distributed with Fedora 2.1.&nbsp; PROAI is a stand-alone web application
  that must be secured separately.</span><span style='font-family:Arial;
  color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>A
review of how the policy combining algorithm works, will reveal that access to
a service operation cannot occur unless access is <b><i>expressly permitted.</i></b>&nbsp;&nbsp;
The net effect of the default access control policies is that the administrator
is expressly permitted to do anything (with the restriction of having to make
API-M requests from the same IP address that the server runs on),&nbsp; and all
users are expressly permitted access to API-A and OAI service requests.<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<h3 style='line-height:15.0pt'><span style='font-family:Arial'>5.2&nbsp;
Default Utility Policies<o:p></o:p></span></h3>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Generally,
the default repository utility policies <b><i>should not be removed</i></b>.&nbsp;
They enforce core and crucial protections of the repository. Considerate
understanding of how they work should proceed any (unlikely) needed editing.
For example, consider and edit to permit other IPs than localhost, as opposed
simply to deleting the policy.<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<table class=MsoNormalTable border=1 cellpadding=0 width="100%"
 style='width:100.0%;mso-cellspacing:1.5pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>
  </td>
  <td width=78 style='width:58.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>Service</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=416 style='width:312.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp; XACML Policy File</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><b><span
  style='font-family:Arial;color:black'>&nbsp; Policy Description</span></b><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>1<o:p></o:p></span></p>
  </td>
  <td width=78 style='width:58.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>serverAdmin</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=416 style='width:312.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/default/repository-wide/deny-policy-management-if-not-administrator.xml">deny-policy-management-if-not-administrator.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>2<o:p></o:p></span></p>
  </td>
  <td width=78 style='width:58.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>any</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=416 style='width:312.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/default/repository-wide/deny-inactive-or-deleted-disseminations-if-not-administrator.xml">deny-inactive-or-deleted-disseminations-if-not-administrator.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>This is a
  &quot;negative policy&quot; that will deny all access to inactive/deleted
  disseminations if the user/agent is not the Fedora administrator.&nbsp;&nbsp;
  Unlike purged disseminations, inactive/deleted disseminations still exist,
  but they are just marked as inactive/deleted.&nbsp;&nbsp; As such they should
  not be available to users.&nbsp; The exception is that the Fedora
  administrator is allowed to access them.&nbsp; </span><span style='font-family:
  Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>3<o:p></o:p></span></p>
  </td>
  <td width=78 style='width:58.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>any</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=416 style='width:312.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/default/repository-wide/deny-inactive-or-deleted-objects-or-datastreams-if-not-administrator.xml">deny-inactive-or-deleted-objects-or-datastreams-if-not-administrator.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>This is a
  &quot;negative policy&quot; that will deny all access to inactive/deleted
  datastreams if the user/agent is not the Fedora administrator.&nbsp;&nbsp;
  Unlike purged objects/datastreams, inactive/deleted objects/datastreams still
  exist, but they are just marked as inactive/deleted.&nbsp;&nbsp; As such they
  should not be available to users.&nbsp; The exception is that the Fedora
  administrator is allowed to access them.&nbsp; </span><span style='font-family:
  Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>4<o:p></o:p></span></p>
  </td>
  <td width=78 style='width:58.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>API-M</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=416 style='width:312.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/default/repository-wide/deny-purge-datastream-if-active-or-inactive.xml">deny-purge-datastream-if-active-or-inactive.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>This is a
  &quot;negative policy&quot; that will ensure that datastreams cannot be
  purged (permanently removed) unless they are in the deleted state.&nbsp;
  Purging of active or inactive datastreams is not allowed.&nbsp; </span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>5<o:p></o:p></span></p>
  </td>
  <td width=78 style='width:58.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>API-M</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=416 style='width:312.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/default/repository-wide/deny-purge-object-if-active-or-inactive.xml">deny-purge-object-if-active-or-inactive.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>This is a
  &quot;negative policy&quot; that will ensure that objects cannot be purged
  (permanently removed) unless they are in the &quot;deleted&quot; state.&nbsp;
  Purging of active or inactive objects not allowed. </span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>6<o:p></o:p></span></p>
  </td>
  <td width=78 style='width:58.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>serverAdmin</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=416 style='width:312.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/default/repository-wide/deny-reloadPolicies-if-not-localhost.xml">deny-reloadPolicies-if-not-localhost.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>This is a &quot;negative
  policy&quot; that will deny requests to reload policies (i.e., policy
  reactivation) if this requests is not initiated from the IP address of the
  machine on which the repository is running (i.e., localhost).</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>7<o:p></o:p></span></p>
  </td>
  <td width=78 style='width:58.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>serverAdmin</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=416 style='width:312.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/default/repository-wide/deny-serverShutdown-if-not-localhost.xml">deny-serverShutdown-if-not-localhost.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>This is a
  &quot;negative policy&quot; that will deny requests to shutdown the Fedora
  server if this requests is not initiated from the IP address of the machine
  on which the repository is running (i.e., localhost).</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>8<o:p></o:p></span></p>
  </td>
  <td width=78 style='width:58.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>serverAdmin</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=416 style='width:312.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/default/repository-wide/permit-adminPing-unrestricted.xml">permit-adminPing-unrestricted.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>This is a
  &quot;positive policy&quot; that permits unrestricted access for pinging of
  the Fedora server.</span><span style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9;mso-yfti-lastrow:yes'>
  <td width=41 style='width:30.75pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-family:Arial;color:black'>9<o:p></o:p></span></p>
  </td>
  <td width=78 style='width:58.5pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>serverAdmin</span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td width=416 style='width:312.0pt;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'><a
  href="xacml-policies/default/repository-wide/permit-serverStatus-unrestricted.xml">permit-serverStatus-unrestricted.xml</a></span><span
  style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
  <td style='padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal style='margin:0in;margin-bottom:.0001pt;line-height:15.0pt'><span
  style='font-size:10.0pt;font-family:Arial;color:black'>This is a
  &quot;positive policy&quot; that permits unrestricted access for obtaining
  the Fedora server status.</span><span style='font-family:Arial;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><span style='font-size:14.0pt;font-family:
Arial;color:black'>&nbsp;</span></b><span style='font-family:Arial;color:black'><o:p></o:p></span></p>

<h2 style='mso-line-height-alt:15.0pt'><a name=CUSTOM><span style='font-family:
Arial'>6 Sample Policies for Typical Fedora Use</span></a><span
style='font-family:Arial'><o:p></o:p></span></h2>

<p style='line-height:15.0pt'><b><span style='font-size:14.0pt;font-family:
Arial;color:black'>&nbsp;</span></b><span style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>The
Fedora Policy Enforcement Module is intended to provide a flexible means of
creating access control for a repository and for digital objects within a
repository.&nbsp;&nbsp; Therefore, it is expected that each Fedora repository
will have XACML policies appropriate for specific contexts and use
cases.&nbsp;&nbsp;&nbsp; All repositories will start off, out-of-the-box, with
the set of default repository policies.&nbsp;&nbsp; These policies set up a
world where (1) users in the Fedora administrator role are permitted to do
anything (see permit-anything-to-administrator.xml), (2) access to the API-M
service is restricted to localhost (</span><span style='font-size:10.0pt;
font-family:Arial;color:black'>deny-apim-if-not-localhost.xml)</span><span
style='font-family:Arial;color:black'>, and (3) the Fedora API-A service is
totally unrestricted (see permit-apia-unrestricted.xml).<o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Given
this out-of-the-box starting point, the perspective that can be taken to easily
understand how to write new custom policies is:<o:p></o:p></span></p>

<ul type=disc>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l3 level1 lfo8;
     tab-stops:list .5in'><span style='font-family:Arial'>write new policies to
     <b><i>tighten up </i></b>access controls for the API-A service&nbsp;
     (i.e., start to selectively deny access)<o:p></o:p></span></li>
 <li class=MsoNormal style='color:black;line-height:15.0pt;mso-list:l3 level1 lfo8;
     tab-stops:list .5in'><span style='font-family:Arial'>write new policies to<b><i>
     loosen up</i></b> access controls for the API-M service (i.e., start to
     selectively permit access)<o:p></o:p></span></li>
</ul>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>Please
consult the <a href="XACMLPolicyGuide.htm">Sample Policy Guide</a> which
describes a reference collection of sample policies that would be useful for
Fedora repositories.&nbsp;&nbsp; The collection contains examples of
repository-wide and object-specific policies for restricting access to groups
of digital objects based on certain attributes of the objects, for restricting
access to certain kinds of datastreams and disseminations, for selectively
permitting access to different API-M operations, and more.&nbsp;&nbsp; These
policies can be found within the Fedora software distribution in the following
directory:&nbsp;&nbsp;&nbsp; </span><b><span style='font-family:"Courier New";
color:black'>FEDORA_HOME/userdocs/server/security/xacml-policies/examples</span></b><span
style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-family:
Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt;text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:black'>&nbsp;</span><span style='font-family:
Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

<p style='line-height:15.0pt'><b><span style='font-size:14.0pt;font-family:
Arial;color:black'>&nbsp;</span></b><span style='font-family:Arial;color:black'><o:p></o:p></span></p>

<p style='line-height:15.0pt'><span style='font-family:Arial;color:black'>&nbsp;<o:p></o:p></span></p>

</div>

</body>

</html>
